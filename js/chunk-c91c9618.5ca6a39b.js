(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c91c9618"],{"18cf":function(e,t,o){"use strict";o("5cb5")},"2b05":function(e,t,o){},"2e77":function(e,t,o){"use strict";o("9987")},"42be":function(e,t,o){},"5cb5":function(e,t,o){},"8d9c":function(e,t,o){"use strict";o("42be")},"95f1":function(e,t,o){"use strict";o("a560")},9987:function(e,t,o){},a55b:function(e,t,o){"use strict";o.r(t);var s=o("7a23");const c=e=>(Object(s["pushScopeId"])("data-v-4133e166"),e=e(),Object(s["popScopeId"])(),e),n={class:"profile-page"},l={class:"profile-header"},a=c(()=>Object(s["createElementVNode"])("h1",null,"Панель администратора",-1)),i=c(()=>Object(s["createElementVNode"])("hr",null,null,-1)),r={class:"profile-main"},d=c(()=>Object(s["createElementVNode"])("h2",null,"Посты:",-1)),p={key:1,class:"post-list"},m={key:2};function b(e,t,o,c,b,O){const u=Object(s["resolveComponent"])("post-item"),j=Object(s["resolveComponent"])("create-post"),h=Object(s["resolveComponent"])("edit-post");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",n,[Object(s["createElementVNode"])("header",l,[a,Object(s["createElementVNode"])("p",null,"user-id: "+Object(s["toDisplayString"])(O.userId),1),i]),Object(s["createElementVNode"])("main",r,[b.isCreateFormOpen?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("button",{key:0,class:"btn-opener",onClick:t[0]||(t[0]=(...e)=>O.openCreateForm&&O.openCreateForm(...e))}," + Добавить пост ")),d,O.postList?(Object(s["openBlock"])(),Object(s["createElementBlock"])("ul",p,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(O.postList,e=>(Object(s["openBlock"])(),Object(s["createBlock"])(u,{key:e.id,post:e,class:"post-item-block",onOpenEditForm:t=>O.openEditForm(e)},null,8,["post","onOpenEditForm"]))),128))])):(Object(s["openBlock"])(),Object(s["createElementBlock"])("p",m,"Список пуст.."))]),b.isCreateFormOpen?(Object(s["openBlock"])(),Object(s["createBlock"])(j,{key:0,onCloseForm:t[1]||(t[1]=e=>b.isCreateFormOpen=!1)})):Object(s["createCommentVNode"])("",!0),b.isEditFormOpen?(Object(s["openBlock"])(),Object(s["createBlock"])(h,{key:1,postForEdit:b.post,onCloseForm:t[2]||(t[2]=e=>b.isEditFormOpen=!1)},null,8,["postForEdit"])):Object(s["createCommentVNode"])("",!0)])}const O=e=>(Object(s["pushScopeId"])("data-v-6a93a774"),e=e(),Object(s["popScopeId"])(),e),u={class:"create-post"},j=O(()=>Object(s["createElementVNode"])("header",{class:"header"},[Object(s["createElementVNode"])("h1",{class:"header__title"},"Загрузка файлов")],-1)),h={action:"#",class:"form"},g={class:"input-block"},v={class:"input-block"},E={class:"input-block"},k={class:"input-block"},N={key:0},V={class:"btn-block"};function f(e,t,o,c,n,l){const a=Object(s["resolveComponent"])("select-files-btn"),i=Object(s["resolveComponent"])("images-upload");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",u,[j,Object(s["createElementVNode"])("form",h,[Object(s["createElementVNode"])("div",g,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.postType=e),type:"text",placeholder:"тип поста"},null,512),[[s["vModelText"],n.postType]])]),Object(s["createElementVNode"])("div",v,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.eventType=e),type:"text",placeholder:"тип события"},null,512),[[s["vModelText"],n.eventType]])]),Object(s["createElementVNode"])("div",E,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.title=e),type:"text",placeholder:"заголовок"},null,512),[[s["vModelText"],n.title]])]),Object(s["createElementVNode"])("div",k,[Object(s["withDirectives"])(Object(s["createElementVNode"])("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.text=e),name:"",id:"",cols:"30",rows:"10",placeholder:"введите текст"},null,512),[[s["vModelText"],n.text]])])]),Object(s["createVNode"])(a,{onOnReadFiles:e.readFiles},null,8,["onOnReadFiles"]),Object(s["createVNode"])(i,{previewList:e.previewList,class:"image-block"},null,8,["previewList"]),l.getProcessing?(Object(s["openBlock"])(),Object(s["createElementBlock"])("h1",N,"Loading...")):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("div",V,[Object(s["createElementVNode"])("button",{class:"btn mr-16",onClick:t[4]||(t[4]=t=>e.$emit("closeForm"))},"Закрыть"),Object(s["createElementVNode"])("button",{class:"btn btn-submit",type:"submit",onClick:t[5]||(t[5]=Object(s["withModifiers"])((...e)=>l.savePost&&l.savePost(...e),["prevent"]))},"Сохранить")])])}const I={class:"btn-upload-block"};function y(e,t,o,c,n,l){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",I,[Object(s["createElementVNode"])("button",{class:"btn trigger-btn",onClick:t[0]||(t[0]=Object(s["withModifiers"])((...e)=>l.triggerUpload&&l.triggerUpload(...e),["prevent"]))}," Выбрать фото "),Object(s["createElementVNode"])("input",{type:"file",name:"file",ref:"fileInputCreate",style:{display:"none"},accept:"image/*",multiple:"",onChange:t[1]||(t[1]=(...e)=>l.readFilesHandler&&l.readFilesHandler(...e))},null,544)])}var B={name:"SelectFilesBtn",methods:{triggerUpload(){this.$refs.fileInputCreate.click()},readFilesHandler(e){this.$emit("onReadFiles",e)}}},L=(o("c798"),o("6b0d")),F=o.n(L);const C=F()(B,[["render",y],["__scopeId","data-v-7dec626d"]]);var w=C;const T=e=>(Object(s["pushScopeId"])("data-v-c0c74d5e"),e=e(),Object(s["popScopeId"])(),e),P={class:"preview"},S={key:0,class:"loaded-list"},_=["src"],x=["onClick"],$={class:"loaded-item__info"},M={key:1,class:"before-loaded-list"},D=T(()=>Object(s["createElementVNode"])("div",{class:"progress"},[Object(s["createElementVNode"])("div",{class:"progress-bar"})],-1));function U(e,t,o,c,n,l){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",P,[l.postImageList?(Object(s["openBlock"])(),Object(s["createElementBlock"])("ul",S,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(l.postImageList,e=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("li",{key:e.url,class:Object(s["normalizeClass"])([{removing:n.removingImageName===e.name},"loaded-item"])},[Object(s["createElementVNode"])("img",{src:e.url,alt:"фотка"},null,8,_),Object(s["createElementVNode"])("div",{class:"remove-btn",onClick:t=>l.deleteImage(e.name)},"×",8,x),Object(s["createElementVNode"])("div",$,[Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.name),1),Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(l.convertSize(e.size)),1)])],2))),128))])):Object(s["createCommentVNode"])("",!0),o.previewList.length?(Object(s["openBlock"])(),Object(s["createElementBlock"])("ul",M,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(o.previewList,e=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("li",{key:e.url,class:"preview-item"},[D,Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.name),1)]))),128))])):Object(s["createCommentVNode"])("",!0),l.postImageList.length?(Object(s["openBlock"])(),Object(s["createElementBlock"])("a",{key:2,href:"#",class:"remove-all-btn",onClick:t[0]||(t[0]=Object(s["withModifiers"])((...e)=>l.deleteAllImages&&l.deleteAllImages(...e),["prevent"]))}," Удалить все ")):Object(s["createCommentVNode"])("",!0)])}function A(e){const t=["Bytes","KB","MB","GB","TB"];if(!e)return"0 Byte";const o=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,o))+" "+t[o]}var R={name:"ImagesUpload",props:["previewList"],data(){return{removingImageName:""}},computed:{postImageList(){return this.$store.getters.postImageList}},methods:{convertSize(e){return A(e)},async deleteImage(e){this.removingImageName=e,await this.$store.dispatch("deleteImage",e);const t=this.postImageList.filter(t=>t.name!==e);this.$store.commit("UPDATE_POST_IMAGE_LIST",t),this.removingImageName=""},deleteAllImages(){for(let e of this.postImageList)this.removingImageName=e.name,this.deleteImage(e.name),this.removingImageName=""}}};o("c8c7");const z=F()(R,[["render",U],["__scopeId","data-v-c0c74d5e"]]);var H=z,G={data(){return{files:[],previewList:[]}},computed:{postImageList(){return this.$store.getters.postImageList}},watch:{postImageList(){this.previewList=[],this.files=[]},previewList:{handler(){this.previewList.length===this.files.length&&setTimeout(()=>{this.uploadImages()},100)},deep:!0}},methods:{readFiles(e){this.files=[],this.previewList=[],this.files=Array.from(e.target.files),this.files.length>2?alert("Не больше 2 файлов!"):this.files.forEach(e=>{if(!e.type.match("image"))return;const t=new FileReader;t.onload=t=>{const o=t.target.result;this.previewList.push({name:e.name,size:e.size,url:o})},t.readAsDataURL(e)})},uploadImages(){this.$store.dispatch("uploadImages",this.files)}}},Y={name:"CreatePost",components:{SelectFilesBtn:w,ImagesUpload:H},mixins:[G],data(){return{postType:"",eventType:"",title:"",text:""}},computed:{getProcessing(){return this.$store.getters.getProcessing},postImageList(){return this.$store.getters.postImageList}},methods:{async savePost(){""!==this.postType&&""!==this.eventType&&""!==this.title&&""!==this.text?(await this.$store.dispatch("savePost",{postType:this.postType,eventType:this.eventType,title:this.title,text:this.text,imageList:this.postImageList}),this.$emit("closeForm")):alert("заполните поля!")}}};o("8d9c");const J=F()(Y,[["render",f],["__scopeId","data-v-6a93a774"]]);var K=J;const q=e=>(Object(s["pushScopeId"])("data-v-61e6d2f2"),e=e(),Object(s["popScopeId"])(),e),Q={class:"edit-post"},W=q(()=>Object(s["createElementVNode"])("header",{class:"header"},[Object(s["createElementVNode"])("h1",{class:"header__title"},"Загрузка файлов")],-1)),X={action:"#",class:"form"},Z={class:"input-block"},ee={class:"input-block"},te={class:"input-block"},oe={class:"input-block"},se={key:0},ce={class:"btn-block"};function ne(e,t,o,c,n,l){const a=Object(s["resolveComponent"])("select-files-btn"),i=Object(s["resolveComponent"])("images-upload");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Q,[W,Object(s["createElementVNode"])("form",X,[Object(s["createElementVNode"])("div",Z,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.post.postType=e),type:"text",placeholder:"тип поста"},null,512),[[s["vModelText"],n.post.postType]])]),Object(s["createElementVNode"])("div",ee,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.post.eventType=e),type:"text",placeholder:"тип события"},null,512),[[s["vModelText"],n.post.eventType]])]),Object(s["createElementVNode"])("div",te,[Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.post.title=e),type:"text",placeholder:"заголовок"},null,512),[[s["vModelText"],n.post.title]])]),Object(s["createElementVNode"])("div",oe,[Object(s["withDirectives"])(Object(s["createElementVNode"])("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.post.text=e),name:"",id:"",cols:"30",rows:"10",placeholder:"введите текст"},null,512),[[s["vModelText"],n.post.text]])])]),Object(s["createVNode"])(a,{onOnReadFiles:e.readFiles},null,8,["onOnReadFiles"]),Object(s["createVNode"])(i,{previewList:e.previewList,class:"image-block"},null,8,["previewList"]),l.getProcessing?(Object(s["openBlock"])(),Object(s["createElementBlock"])("h1",se,"Loading...")):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("div",ce,[Object(s["createElementVNode"])("button",{class:"btn mr-16",onClick:t[4]||(t[4]=t=>e.$emit("closeForm"))},"Закрыть"),Object(s["createElementVNode"])("button",{class:"btn btn-submit",type:"submit",onClick:t[5]||(t[5]=Object(s["withModifiers"])((...e)=>l.updatePost&&l.updatePost(...e),["prevent"]))},"Сохранить")])])}var le={name:"EditPost",components:{SelectFilesBtn:w,ImagesUpload:H},props:["postForEdit"],mixins:[G],data(){return{post:this.postForEdit}},computed:{getProcessing(){return this.$store.getters.getProcessing},postImageList(){return this.$store.getters.postImageList}},methods:{async updatePost(){this.post.imageList=this.postImageList,""!==this.post.title&&""!==this.post.text?(this.$store.commit("SET_PROCESSING",!0),await this.$store.dispatch("updatePost",this.post),this.$store.commit("SET_PROCESSING",!1)):alert("заполните поля!")}},mounted(){}};o("95f1");const ae=F()(le,[["render",ne],["__scopeId","data-v-61e6d2f2"]]);var ie=ae;const re={class:"post-item"},de={class:"post-header"},pe={class:"right"},me={class:"post-body"},be={class:"title"},Oe={class:"image-list"},ue={class:"img-block"},je=["src","alt"],he=["innerHTML"],ge={class:"post-footer"},ve={key:0};function Ee(e,t,o,c,n,l){return Object(s["openBlock"])(),Object(s["createElementBlock"])("li",re,[Object(s["createElementVNode"])("header",de,[Object(s["createElementVNode"])("div",{class:Object(s["normalizeClass"])(["left",{red:"Aнонс"===o.post.postType}])},Object(s["toDisplayString"])(o.post.postType),3),Object(s["createElementVNode"])("div",pe,Object(s["toDisplayString"])(l.getDate(o.post.id)),1)]),Object(s["createElementVNode"])("main",me,[Object(s["createElementVNode"])("h3",be,Object(s["toDisplayString"])(o.post.title),1),Object(s["createElementVNode"])("ul",Oe,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(o.post.imageList,e=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("li",{class:"image-item mr-16",key:e.url},[Object(s["createElementVNode"])("div",ue,[Object(s["createElementVNode"])("img",{src:e.url,alt:e.name},null,8,je)])]))),128))]),Object(s["createElementVNode"])("div",{innerHTML:o.post.text,class:"body"},null,8,he)]),Object(s["createElementVNode"])("footer",ge,[Object(s["createElementVNode"])("button",{class:"btn btn__blue",onClick:t[0]||(t[0]=(...e)=>l.openEditForm&&l.openEditForm(...e))}," Редактировать "),l.getProcessing?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ve,"Deleting...")):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("button",{class:"btn btn__red",onClick:t[1]||(t[1]=(...e)=>l.deletePost&&l.deletePost(...e))}," Удалить ")])])}var ke=o("c1df"),Ne=o.n(ke),Ve={name:"PostItem",props:["post"],computed:{getProcessing(){return this.$store.getters.getProcessing}},methods:{convertSize(e){return A(e)},async deletePost(){confirm("Лена, ты правда хочешь удалить этот пост???   (°□°) ")&&(this.post.imageList&&this.post.imageList.forEach(e=>{this.$store.dispatch("deleteImage",e.name)}),await this.$store.dispatch("removePost",this.post.id))},openEditForm(){this.$emit("openEditForm")},getDate(e){return Ne.a.locale("ru"),Ne.a.unix(e/1e3).format("DD.MM.YYYY, HH:mm")}}};o("18cf");const fe=F()(Ve,[["render",Ee],["__scopeId","data-v-4a866227"]]);var Ie=fe,ye={name:"AdminPage",components:{CreatePost:K,EditPost:ie,PostItem:Ie},data(){return{isCreateFormOpen:!1,isEditFormOpen:!1,post:{}}},computed:{userId(){return this.$store.getters.userId},postList(){return this.$store.getters.postList}},methods:{openCreateForm(){this.isCreateFormOpen=!0},closeCreateForm(){this.isCreateFormOpen=!1},openEditForm(e){console.log(e.imageList),this.$store.commit("UPDATE_POST_IMAGE_LIST",e.imageList||[]),this.post=e,this.isEditFormOpen=!0},closeEditForm(){this.isEditFormOpen=!1}},async mounted(){await this.$store.dispatch("getPostList")}};o("2e77");const Be=F()(ye,[["render",b],["__scopeId","data-v-4133e166"]]);t["default"]=Be},a560:function(e,t,o){},b2f1:function(e,t,o){},c798:function(e,t,o){"use strict";o("2b05")},c8c7:function(e,t,o){"use strict";o("b2f1")}}]);
//# sourceMappingURL=chunk-c91c9618.5ca6a39b.js.map